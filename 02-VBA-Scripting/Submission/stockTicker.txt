Sub stockTicker()    'declare worksheet    Dim ws As Worksheet        ' Set begin var to contain the stock name    Dim stock_Name As String        ' Set begin var to contain the total for every stock brand    Dim stock_Total As Double        ' Declare i    Dim i As Double        ' Last Row    Dim lastRow As Double        ' Follow the location for each brand in the ST    Dim summary_Table_row As Integer        'open and close prices    Dim openPrice As Double    Dim closePrice As Double    Dim yearlyChange As Double    Dim percentChange As Double'One ring to Loop them all    For Each ws In Worksheets            ' second summary table vars        Dim greatInc_Stock As String        Dim greatDec_Stock As String        Dim mostVol_Stock As String                Dim greatInc As Double        Dim greatDec As Double        Dim mostVol As Double                    ' init vars        stock_Total = 0        LastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row        summary_Table_row = 2        greatInc = 0        greatDec = 0        mostVol = 0                ' Open/Close Prices        openPrice = ws.Cells(2, 3).Value                ' Loop all purchases        For i = 2 To LastRow                    ' Add to the Stock Total            stock_Total = stock_Total + ws.Cells(i, 7).Value                    ' Check if we're in the same ticker. Else if..            If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then                'Grab the closing price                closePrice = ws.Cells(i, 6).Value                                'Yearly Change                yearlyChange = closePrice - openPrice                                'Percent Change                ' deal with divide by 0                If openPrice = 0 Then                    percentChange = 100 * (yearlyChange / 1E-07)                Else:                    percentChange = 100 * (yearlyChange / openPrice)                End If                                ' Set stock name                Stock_Name = ws.Cells(i, 1).Value                                ' Print ticker                ws.Range("I" & summary_Table_row).Value = Stock_Name                                ' Print change per year to the summary table                ws.Range("J" & summary_Table_row).Value = yearlyChange                                ' Color cells by performance                If yearlyChange > 0 Then                    ws.Range("J" & summary_Table_row).Interior.ColorIndex = 4                ElseIf yearlyChange < 0 Then                    ws.Range("J" & summary_Table_row).Interior.ColorIndex = 3                Else                    ws.Range("J" & summary_Table_row).Interior.ColorIndex = 2                End If                                ' Print year end change to the Summary Table                ws.Range("K" & summary_Table_row).Value = percentChange                                ' Print amount to the summary table                ws.Range("L" & summary_Table_row).Value = stock_Total                                ' Add one to the summary table row                summary_Table_row = summary_Table_row + 1                                ' Reset the brand total                stock_Total = 0                openPrice = ws.Cells(i + 1, 3)                End If                        Next i                     ' Loop through memory table to make summary table 2.0        For i = 2 To summary_Table_row        ' three conditionals            If ws.Cells(i, 11).Value > greatInc Then                greatInc = ws.Cells(i, 11).Value                greatInc_Stock = ws.Cells(i, 9)            End If            If ws.Cells(i, 11).Value < greatDec Then                greatDec = ws.Cells(i, 11).Value                greatDec_Stock = ws.Cells(i, 9)            End If            If ws.Cells(i, 12).Value > mostVol Then                mostVol = ws.Cells(i, 12).Value                mostVol_Stock = ws.Cells(i, 9)            End If        Next i                    ' write to 2nd summary table            ws.Range("O2").Value = greatInc_Stock            ws.Range("P2").Value = greatInc            ws.Range("O3").Value = greatDec_Stock            ws.Range("P3").Value = greatDec            ws.Range("O4").Value = mostVol_Stock            ws.Range("P4").Value = mostVol                        Next ws    End Sub    